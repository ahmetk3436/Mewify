{
  "tasks": [
    {
      "id": "enhance_001",
      "title": "Backend: AI Face Analysis with OpenAI Vision API",
      "description": "Create a new AI analysis service and endpoint that accepts a base64 image and returns real AI-scored face analysis using OpenAI GPT-4o-mini (free tier) or GPT-4o (premium tier).\n\nFiles to modify:\n- backend/internal/config/config.go: Add OpenAIAPIKey string field, load from OPENAI_API_KEY env var. Add OpenAIModel string field defaulting to 'gpt-4o-mini'.\n- backend/internal/services/ai_analysis_service.go (NEW): Create AiAnalysisService struct with db *gorm.DB and cfg *config.Config fields. Method AnalyzeImage(userID uuid.UUID, imageBase64 string) (*models.FaceAnalysis, error) that: (1) Builds OpenAI API request to POST https://api.openai.com/v1/chat/completions with model from config, (2) System prompt instructs GPT to analyze the face photo and return JSON with fields: overall_score(1-10 float), symmetry_score, jawline_score, skin_score, eye_score, nose_score, lips_score, harmony_score, strengths([]string, 3 items), improvements([]string, 3 items), (3) User message contains image_url with data:image/jpeg;base64,{imageBase64} content type, (4) Parses the JSON response via json.Unmarshal into a struct, (5) Creates FaceAnalysis model record in database with all scores and returns it. Use net/http for the API call with 30s timeout. Add OPENAI_API_KEY to config.go Load() function.\n- backend/internal/handlers/ai_analysis_handler.go (NEW): Create AiAnalysisHandler with the service. Single endpoint AnalyzeFace(c *fiber.Ctx) that parses {\"image_base64\": \"...\"} body, extracts userID from JWT locals, calls service.AnalyzeImage(), returns the full FaceAnalysisResponse DTO.\n- backend/internal/routes/routes.go: Add protected.Post(\"/analyses/ai\", aiAnalysisHandler.AnalyzeFace) route. Import and wire the new handler in Setup() params.\n- backend/cmd/server/main.go: Create aiAnalysisService := services.NewAiAnalysisService(database.DB, cfg), create aiAnalysisHandler, pass to routes.Setup().\n\nThe OpenAI request body structure: {\"model\": cfg.OpenAIModel, \"messages\": [{\"role\": \"system\", \"content\": \"You are a facial aesthetics AI...Return ONLY valid JSON...\"}, {\"role\": \"user\", \"content\": [{\"type\": \"image_url\", \"image_url\": {\"url\": \"data:image/jpeg;base64,...\"}}]}], \"max_tokens\": 1000}. Parse response.choices[0].message.content as JSON into the scores struct.",
      "status": "completed",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-06T22:29:05Z"
    },
    {
      "id": "enhance_002",
      "title": "Backend: Fix Auth Stubs (Refresh Token + Logout + Apple JWT)",
      "description": "Fix three critical auth stubs that currently return placeholder responses.\n\nFiles to modify:\n\n1. backend/internal/handlers/auth_handler.go - Refresh method (lines 59-62): Replace stub with real implementation. Parse RefreshTokenRequest body, call h.service.RefreshToken(req.RefreshToken), return new access token. Logout method (lines 89-92): Parse {\"refresh_token\": \"...\"} body, call h.service.Logout(refreshToken) to revoke the token in DB.\n\n2. backend/internal/services/auth_service.go:\n- Add RefreshToken(refreshTokenStr string) (string, error) method: (a) Hash the incoming refresh token with SHA-256, (b) Query RefreshToken model where token_hash = hashed AND revoked = false AND expires_at \u003e now, (c) If not found return error, (d) Generate new access JWT via generateJWT(token.UserID), (e) Return new access token string.\n- Add Logout(refreshTokenStr string) error method: (a) Hash the token, (b) Update RefreshToken set revoked = true where token_hash = hashed.\n- Fix Register and Login to also generate refresh tokens: After generating access JWT, create a random 64-byte token via crypto/rand, SHA-256 hash it, store hash in RefreshToken model with user_id, expires_at = now + cfg.JWTRefreshExpiry. Return both access_token and raw refresh_token string to client.\n- Fix AppleSignIn (line 93): Replace hardcoded email 'apple_user@example.com' with real Apple JWT parsing. Decode the identityToken as JWT (it's a standard JWT from Apple), extract the 'email' claim from payload without full signature verification (Apple tokens are verified client-side by the SDK). Use base64 URL decode on the payload segment: parts := strings.Split(identityToken, \".\"), decode parts[1], unmarshal to get email and sub claims.\n\n3. backend/internal/handlers/auth_handler.go - Update Register and Login responses to include both \"token\" and \"refresh_token\" fields.\n\nAdd import \"crypto/rand\", \"crypto/sha256\", \"encoding/hex\", \"encoding/base64\", \"strings\" to auth_service.go as needed.",
      "status": "in_progress",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-06T22:29:05Z"
    },
    {
      "id": "enhance_003",
      "title": "Backend: AI-Powered Glow Plan Generation",
      "description": "Replace the mock recommendation generator in glow_plan_service.go with real AI-powered recommendations using OpenAI GPT-4o-mini.\n\nFiles to modify:\n\n1. backend/internal/services/glow_plan_service.go:\n- Add cfg *config.Config to GlowPlanService struct. Update NewGlowPlanService to accept cfg parameter.\n- Replace generateMockRecommendations() (lines 98-150) with generateAIRecommendations(userID, analysisID uuid.UUID, analysis *models.FaceAnalysis) ([]models.GlowPlan, error). This method: (a) Builds a prompt containing the user's scores: 'User face analysis scores: overall={OverallScore}, symmetry={SymmetryScore}, jawline={JawlineScore}, skin={SkinScore}, eye={EyeScore}, nose={NoseScore}, lips={LipsScore}, harmony={HarmonyScore}. Strengths: {Strengths}. Improvements: {Improvements}. Generate 5-7 personalized improvement recommendations as JSON array with fields: category(jawline|skin|style|fitness|grooming), title(short actionable title), description(2-3 sentence detailed advice), difficulty(easy|medium|hard), timeframe_weeks(1-12), priority(1-5, 5=highest). Focus recommendations on lowest-scoring areas.', (b) Calls OpenAI API via POST https://api.openai.com/v1/chat/completions with cfg.OpenAIAPIKey, (c) Parses JSON array response, (d) Creates GlowPlan model for each recommendation.\n- Delete getMockTitle, getMockDescription, getRandomDifficulty helper methods (lines 152-204).\n- Update GenerateGlowPlan to call generateAIRecommendations instead of generateMockRecommendations.\n\n2. backend/cmd/server/main.go: Update NewGlowPlanService call to pass cfg.\n\nKeep the existing database save logic (delete old plans, create new ones in loop). The AI prompt should explicitly request JSON-only output with no markdown formatting.",
      "status": "pending",
      "priority": 10,
      "depends_on": [
        "enhance_001"
      ],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_004",
      "title": "Mobile: 3-Screen Onboarding + Guest Mode + Smart Routing",
      "description": "Create a 3-screen onboarding flow with guest mode support and smart routing logic.\n\nFiles to create/modify:\n\n1. mobile/app/onboarding.tsx (NEW): Create OnboardingScreen with 3 pages using horizontal ScrollView with pagingEnabled and Dimensions.get('window').width per page. State: currentPage (number). Page 1: Large sparkles icon (Ionicons), title 'Welcome to Mewify' (text-3xl font-bold text-gray-900), subtitle 'AI-powered face analysis \u0026 mewing coach' (text-base text-gray-500), bg-white. Page 2: Large camera icon, title 'Scan \u0026 Analyze', subtitle 'Get instant AI feedback on your facial features with detailed scores', list 3 features with checkmark-circle icons in blue-600. Page 3: Large trophy icon, title 'Track Your Glow-Up', subtitle 'Daily mewing tracker, streaks, and personalized recommendations'. Two buttons: 'Try Free' (bg-blue-600 rounded-2xl py-4, calls handleTryFree) and 'Sign In' (text-blue-600 font-semibold, navigates to /(auth)/login). Dot indicators at bottom: 3 View circles (w-2 h-2 rounded-full), active=bg-blue-600, inactive=bg-gray-300. handleTryFree: sets AsyncStorage 'onboarding_complete' = 'true' and 'guest_mode' = 'true' and 'guest_uses' = '0', then router.replace('/(protected)/(tabs)').\n\n2. mobile/app/index.tsx: Replace current logic with smart routing chain: (a) Check AsyncStorage 'onboarding_complete', if not set ‚Üí router.replace('/onboarding'), (b) Check if authenticated via useAuth ‚Üí router.replace('/(protected)/(tabs)'), (c) Check AsyncStorage 'guest_mode' = 'true' ‚Üí router.replace('/(protected)/(tabs)'), (d) Else ‚Üí router.replace('/(auth)/login').\n\n3. mobile/app/(auth)/login.tsx: Add 'Skip for now' TouchableOpacity below the Sign In button. On press: set AsyncStorage 'guest_mode' = 'true' and 'guest_uses' = '0', router.replace('/(protected)/(tabs)'). Style: text-blue-600 font-medium text-base mt-4.\n\n4. mobile/app/(protected)/_layout.tsx: Modify auth guard to also allow guest mode by checking AsyncStorage 'guest_mode'. If neither authenticated nor guest ‚Üí redirect to login.\n\nUse import AsyncStorage from '@react-native-async-storage/async-storage' ‚Äî wait, this package is not in package.json. Use expo-secure-store's setItemAsync/getItemAsync instead for storing onboarding_complete, guest_mode, guest_uses keys.",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_005",
      "title": "Mobile: Real AI Face Scan Screen with Camera",
      "description": "Create a proper face scan screen that captures a photo, sends base64 to the new AI analysis endpoint, and navigates to the analysis result screen.\n\nFiles to create/modify:\n\n1. mobile/app/(protected)/scan.tsx (NEW): Create ScanScreen component. States: isCapturing(bool), isAnalyzing(bool), analysisProgress(string). Flow: (a) On mount, immediately request camera permission via ImagePicker.requestCameraPermissionsAsync(). (b) If granted, auto-launch camera: ImagePicker.launchCameraAsync({ allowsEditing: true, aspect: [3, 4], quality: 0.7, cameraType: ImagePicker.CameraType.front, base64: true }). (c) If user cancels camera, show centered View with 'camera-outline' icon (size 64, gray-300), text 'No photo taken' (text-gray-500), and 'Try Again' button (bg-blue-600 rounded-xl py-3). (d) If photo captured, show the photo as Image (rounded-2xl, h-80, w-full) with analyzing overlay. Set isAnalyzing=true, show ActivityIndicator with text 'Analyzing your features...' then 'Almost there...' after 3s. (e) Call api.post('/analyses/ai', { image_base64: result.assets[0].base64 }). (f) On success: hapticSuccess(), router.replace(`/(protected)/analysis/${response.data.data.id}`). (g) On error: hapticError(), show Alert with retry option. (h) Guest mode check: read 'guest_uses' from expo-secure-store, if \u003e= 3, show paywall alert 'Free scans used! Sign up for unlimited access' with 'Sign Up' and 'Cancel' buttons.\n\nStyling: SafeAreaView bg-gray-50, analyzing state has white card (bg-white rounded-3xl mx-4 p-6 shadow-lg) containing the photo preview, a pulsing ActivityIndicator (color #2563eb), and status text.\n\n2. mobile/app/(protected)/(tabs)/index.tsx: Update handleScanFace to: router.push('/(protected)/scan') instead of opening camera directly. Remove the mock delay, mock navigation to /results, and all inline camera logic. Keep the camera permission request as a pre-check only.\n\n3. mobile/app/(protected)/_layout.tsx: Add scan to the hidden screens array (href: null) so it doesn't appear in tab bar.",
      "status": "pending",
      "priority": 8,
      "depends_on": [
        "enhance_001",
        "enhance_004"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_006",
      "title": "Mobile: Connect Analysis Detail Screen to Real API",
      "description": "Replace all mock data in the analysis detail screen with real API data fetched from the backend.\n\nFiles to modify:\n\n1. mobile/app/(protected)/analysis/[id].tsx: Complete rewrite of data loading. Remove the entire mock data object (lines 36-67 with hardcoded overallScore: 8.4, Unsplash URL, static scores). Replace with real API call:\n- In useEffect, call api.get(`/analyses/${id}`) to fetch real analysis data.\n- Map response fields: data.data.overall_score ‚Üí overallScore, data.data.symmetry_score ‚Üí scores.symmetry, data.data.jawline_score ‚Üí scores.jawline, data.data.skin_score ‚Üí scores.skin, data.data.eye_score ‚Üí scores.eyes, data.data.nose_score ‚Üí scores.nose, data.data.lips_score ‚Üí scores.lips, data.data.harmony_score ‚Üí scores.harmony, data.data.strengths ‚Üí strengths, data.data.improvements ‚Üí improvements, data.data.image_url ‚Üí imageUri.\n- Add error state (isError: boolean, errorMessage: string). On API error, show error screen with 'alert-circle-outline' icon (size 48, red-400), error message text, and 'Go Back' button.\n- Fix bottom buttons: 'View Your Glow Plan' ‚Üí router.push('/(protected)/glow-plan') (was '/(protected)/plan' which doesn't exist). 'Scan Again' ‚Üí router.push('/(protected)/scan') (now exists after enhance_005).\n- Add pull-to-refresh via RefreshControl on ScrollView with onRefresh callback that re-fetches the analysis.\n- Import RefreshControl from react-native.\n\n2. mobile/components/analysis/ShareButton.tsx: Update to use expo-sharing instead of just clipboard. Import * as Sharing from 'expo-sharing'. In handleShare: first try Sharing.isAvailableAsync(), if available use Sharing.shareAsync() with a message string, else fall back to clipboard copy. The share text format: 'I scored {score}/10 on Mewify! My top strengths: {strengths[0]}, {strengths[1]}. Try it yourself!'",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_005"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_007",
      "title": "Mobile: Connect Glow Plan Screen to Real Backend API",
      "description": "Replace all mock data in glow-plan.tsx with real API calls to the backend glow plan endpoints.\n\nFiles to modify:\n\n1. mobile/app/(protected)/glow-plan.tsx: Remove the entire mockRecommendations array (lines 18-69). Replace with real API integration:\n- Add isLoading state (boolean, default true) and error state (string | null).\n- In useEffect on mount, call loadGlowPlan() which: (a) Calls api.get('/glow-plan') to fetch user's plans, (b) Maps response data to Recommendation[] format: r.id, r.category (capitalize first letter), r.title, r.description, r.difficulty, r.timeframe_weeks ‚Üí timeframeWeeks, r.priority \u003e 3 ‚Üí priority: true, r.is_completed ‚Üí completed, (c) Sets recommendations state, (d) Also calls api.get('/glow-plan/progress') to get progress stats.\n- Update handleToggleComplete: Call api.put(`/glow-plan/${id}/complete`, { is_completed: completed }). On success update local state. On error show Alert and revert.\n- Update handleRegeneratePlan: In the onPress callback, (a) First get latest analysis via api.get('/analyses/latest'), (b) Then call api.post('/glow-plan/generate', { analysis_id: latestAnalysis.id }), (c) Reload the plan list via loadGlowPlan(). If no analysis exists, show Alert: 'No Analysis Found - Take a face scan first to generate your personalized glow plan.' with button to navigate to scan screen.\n- Add loading state: When isLoading, show centered ActivityIndicator (size large, color #2563eb) with text 'Loading your plan...'.\n- Add empty state: When recommendations.length === 0 and !isLoading, show centered view with 'sparkles-outline' icon (size 64, gray-300), text 'No glow plan yet' (text-lg text-gray-500), subtitle 'Take a face scan to get personalized recommendations', and 'Scan Now' button (bg-blue-600) navigating to scan.\n- Add RefreshControl for pull-to-refresh.",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_003",
        "enhance_005"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_008",
      "title": "Mobile: Home Screen with Real API Data + Dashboard Redesign",
      "description": "Replace all mock data on the home screen with real API calls and fix the dashboard to show live data.\n\nFiles to modify:\n\n1. mobile/app/(protected)/(tabs)/index.tsx: Remove all mock data (lines 23-46: userData object and recommendations array). Replace with real API integration:\n- Add states: isLoading(bool), latestAnalysis(object|null), mewingData(object|null), recommendations(array), streakInfo(object|null).\n- Add loadDashboard() async function called in useEffect: (a) api.get('/analyses/latest') ‚Üí set latestAnalysis with overall_score, (b) api.get('/mewing/today') ‚Üí set mewingData with mewing_minutes, (c) api.get('/mewing/goal') ‚Üí get daily_minutes_goal, (d) api.get('/mewing/streaks') ‚Üí set streakInfo with current_streak, longest_streak, total_days_logged, (e) api.get('/glow-plan') ‚Üí set recommendations (first 2 incomplete items), (f) api.get('/analyses/stats') ‚Üí get total_analyses count and monthly_trend for avg score trend calculation. Wrap all in Promise.allSettled to handle partial failures gracefully.\n- Update ScoreRing: Pass latestAnalysis?.overall_score || 0 instead of hardcoded 7.5.\n- Update Quick Stats: streak = streakInfo?.current_streak || 0, totalScans = stats?.total_analyses || 0, trend = calculate from monthly_trend array (last month avg - previous month avg).\n- Update MewingMiniCard: minutesToday = mewingData?.mewing_minutes || 0, dailyGoal = goalData?.daily_minutes_goal || 60, streak = streakInfo?.current_streak || 0.\n- Update GlowPlanPreview: Pass real recommendations from API.\n- Add RefreshControl on ScrollView for pull-to-refresh calling loadDashboard().\n- Show skeleton loading state while isLoading: gray rounded View placeholders (bg-gray-200 rounded-xl h-32 animate-pulse) for each section.\n- Handle empty/first-time user: If no latestAnalysis, show welcome card with 'Take your first scan' CTA instead of ScoreRing.\n\n2. mobile/components/home/MewingMiniCard.tsx: Add onPress prop for 'Log Session' button that navigates to /(protected)/mewing. Currently the button does nothing.\n\n3. mobile/components/home/GlowPlanPreview.tsx: Add onViewAll prop that navigates to /(protected)/glow-plan. Currently 'View All' link does nothing.",
      "status": "pending",
      "priority": 8,
      "depends_on": [
        "enhance_005"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_009",
      "title": "Mobile: Fix Mewing Screen Weekly Calendar with Real API Data",
      "description": "The mewing screen's weekly calendar (weeklyData state) is hardcoded to all-false and never loads real data from the API. Fix this to show actual completion status for the current week.\n\nFiles to modify:\n\n1. mobile/app/(protected)/mewing.tsx:\n- In loadData() function, add a call to api.get('/mewing/history?days=7') after the existing API calls.\n- Parse the history response which returns array of { date, status, minutes } objects.\n- Map the 7-day history to the weeklyData boolean array: For each day of the current week (Monday to Sunday), check if there's a matching history entry with status === 'completed'. The API returns dates in YYYY-MM-DD format; compare against the current week's dates using: const today = new Date(); const dayOfWeek = today.getDay(); const monday = new Date(today); monday.setDate(today.getDate() - ((dayOfWeek + 6) % 7)); Then for each day i (0-6), create date = new Date(monday); date.setDate(monday.getDate() + i); format as YYYY-MM-DD and check against history.\n- Replace the static weeklyData initialization [false, false, false, false, false, false, false] with the computed array.\n- Add isLoading state to show ActivityIndicator while data loads.\n- Add pull-to-refresh with RefreshControl on the ScrollView.\n- After successful handleLogSession, call loadData() to refresh all data including the weekly calendar (this already happens but now weekly data will also update).\n- Add haptic feedback to the Log Session modal's Save button (hapticSuccess on success, hapticError on failure).",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_010",
      "title": "Mobile: Loading/Error/Empty States for All Screens",
      "description": "Add proper loading, error, and empty states to all screens that currently lack them.\n\nFiles to modify:\n\n1. mobile/app/(protected)/progress.tsx: Add isLoading state. While loading, show 3 skeleton placeholder cards (View bg-gray-200 rounded-xl h-40 mb-3 with opacity animation). Add error state with retry button. The current empty state is good but add haptic feedback on 'Take First Scan' button.\n\n2. mobile/app/(protected)/mewing.tsx: Add isLoading state (boolean, default true). While loading, show skeleton views: a rounded-2xl bg-gray-200 h-48 for the progress card, two h-20 side-by-side rounded-xl for streak cards, h-16 rounded-xl for weekly calendar. Set isLoading=false after loadData() completes. Add error state: if all API calls fail, show centered 'wifi-outline' icon (size 48, gray-400), 'Connection error' text, 'Retry' button (bg-blue-600 rounded-xl).\n\n3. mobile/app/(protected)/glow-plan.tsx: Already addressed in enhance_007.\n\n4. mobile/app/(protected)/settings.tsx: Add isLoading state for account deletion (already has isDeleting). Add privacy policy link: Pressable in the Account section with text 'Privacy Policy' (text-blue-600) that opens Linking.openURL('https://mewify.app/privacy'). Add app version display at bottom: Text 'Mewify v1.0.0' (text-xs text-gray-400 text-center mt-auto mb-4). Import { Linking } from 'react-native'.\n\n5. mobile/app/(protected)/(tabs)/index.tsx: Already addressed in enhance_008 with skeleton loading states.\n\nGeneral pattern for all loading states: Use View with className='bg-gray-200 rounded-xl animate-pulse' as skeleton placeholders. General pattern for all error states: centered View with icon, message text (text-gray-500), and retry button (bg-blue-600 rounded-xl py-3 px-6).",
      "status": "pending",
      "priority": 6,
      "depends_on": [
        "enhance_008",
        "enhance_009"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_011",
      "title": "Mobile: Haptic Feedback on All Interactive Elements",
      "description": "Audit and add haptic feedback to every interactive element that currently lacks it. The app has haptics.ts with hapticSuccess, hapticError, hapticWarning, hapticLight, hapticMedium, hapticSelection functions but many touchable elements don't use them.\n\nFiles to modify:\n\n1. mobile/app/(auth)/login.tsx: Add hapticMedium() in handleLogin before the API call. Add hapticError() in the catch block. Add hapticLight() on 'Create Account' and 'Skip for now' link press.\n\n2. mobile/app/(auth)/register.tsx: Add hapticMedium() in handleRegister before API call. Add hapticError() in catch block and validation error cases. Add hapticLight() on 'Sign In' link press.\n\n3. mobile/app/(protected)/progress.tsx: Add hapticSelection() on toggleCompareMode (already has it). Add hapticSelection() on each photo press in handlePhotoPress. Add hapticSuccess() when compare modal opens (both photos selected). Add hapticLight() on close button in compare modal.\n\n4. mobile/app/(protected)/analysis/[id].tsx: Add hapticLight() on back button press. Add hapticMedium() on 'View Your Glow Plan' button press. Add hapticLight() on 'Scan Again' press.\n\n5. mobile/app/(protected)/glow-plan.tsx: hapticSuccess already on toggle complete. Add hapticWarning() on regenerate plan confirmation. Add hapticSelection() on category filter selection (in CategoryFilter component or inline).\n\n6. mobile/app/(protected)/settings.tsx: Add hapticLight() on Sign Out press. Add hapticSelection() on biometric toggle. hapticWarning already on delete.\n\n7. mobile/components/glow-plan/CategoryFilter.tsx: Add hapticSelection() on each category pill press. Import { hapticSelection } from '../../lib/haptics'.\n\n8. mobile/components/home/ScoreRing.tsx: No interaction needed.\n\nImport pattern: import { hapticLight, hapticMedium, hapticSelection, hapticSuccess, hapticError } from '../../lib/haptics' (adjust path per file depth).",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_012",
      "title": "Backend: Rate Limiting + Usage Tracking for Free Tier",
      "description": "Add per-user rate limiting on the AI analysis endpoint to enforce free tier (3 scans/day) vs unlimited for premium users.\n\nFiles to create/modify:\n\n1. backend/internal/models/usage.go (NEW): Create DailyUsage model with fields: ID (uuid, pk), UserID (uuid, indexed), Date (date, composite index with user_id), AnalysisCount (int, default 0), CreatedAt, UpdatedAt. Add to database.go AutoMigrate list.\n\n2. backend/internal/services/usage_service.go (NEW): Create UsageService struct with db *gorm.DB. Methods: (a) CheckAndIncrementUsage(userID uuid.UUID) (bool, int, error): Query DailyUsage for today's date and user. If not exists create with count=1, return (true, 1, nil). If exists and count \u003c FREE_LIMIT (const 3), increment and return (true, newCount, nil). If count \u003e= FREE_LIMIT, check if user has active subscription: query Subscription model where user_id = userID AND status = 'active' AND current_period_end \u003e now(). If subscribed, increment and return (true, newCount, nil). If not subscribed, return (false, count, nil). (b) GetRemainingUses(userID uuid.UUID) (int, error): Return max(0, FREE_LIMIT - todayCount) for non-subscribers, or -1 (unlimited) for subscribers.\n\n3. backend/internal/handlers/ai_analysis_handler.go: Before calling the AI service, call usageService.CheckAndIncrementUsage(userID). If returns false, respond with 429 status: {\"error\": true, \"message\": \"Daily scan limit reached. Upgrade to Premium for unlimited scans.\", \"remaining_uses\": 0, \"is_premium\": false}. On success, include remaining_uses in the response.\n\n4. backend/internal/routes/routes.go: Add GET /api/usage/remaining route (protected) that returns remaining daily uses.\n\n5. backend/cmd/server/main.go: Create usageService, wire into aiAnalysisHandler and add usage handler.\n\n6. backend/internal/database/database.go: Add models.DailyUsage{} to AutoMigrate call.",
      "status": "pending",
      "priority": 9,
      "depends_on": [
        "enhance_001"
      ],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_013",
      "title": "Mobile: Share Results with Native Share API + Result Cards",
      "description": "Upgrade the sharing feature to use React Native's native Share API and expo-sharing for rich sharing experience.\n\nFiles to modify:\n\n1. mobile/components/analysis/ShareButton.tsx: Complete rewrite. Remove clipboard-only approach. New implementation:\n- Import { Share, Platform } from 'react-native' and * as Sharing from 'expo-sharing'.\n- handleShare function: (a) Build share message string: 'I scored {overallScore}/10 on Mewify! üßö‚Äç‚ôÄÔ∏è\\n\\nMy Strengths:\\n‚ú® {strengths[0]}\\n‚ú® {strengths[1]}\\n‚ú® {strengths[2]}\\n\\nDownload Mewify and get your score!', (b) Call Share.share({ message: shareMessage, title: 'My Mewify Score' }). (c) If Share result action === Share.sharedAction, hapticSuccess(). (d) Keep clipboard fallback: if share fails, fall back to Clipboard.setStringAsync().\n- UI update: Replace the current small button with a larger card-style share CTA. View bg-blue-50 rounded-2xl p-4 border border-blue-100. Row layout: left side has share-social-outline icon (24, blue-600), right side has text 'Share Your Results' (text-base font-semibold text-blue-600) and subtitle 'Let your friends know your score' (text-sm text-blue-400). Active state: active:bg-blue-100.\n- Keep the copied success state (green border, checkmark icon) for clipboard fallback.\n\n2. mobile/app/(protected)/analysis/[id].tsx: After the ShareButton, add a 'Share on social' prompt: View with text 'Proud of your score? Share it!' (text-sm text-gray-500 text-center mt-2 mb-4). This encourages engagement.\n\nThe expo-sharing package (v14.0.4) is already in package.json dependencies, so no installation needed.",
      "status": "pending",
      "priority": 6,
      "depends_on": [
        "enhance_006"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_014",
      "title": "Mobile: Delete Legacy Template Files + Fix Broken Routes",
      "description": "Clean up legacy template files and fix all broken navigation routes throughout the app.\n\nFiles to modify/delete:\n\n1. mobile/app/(protected)/home.tsx: DELETE this file entirely. It's a legacy template that shows 'App Factory', 'Welcome {email}', 'Your MVP starts here' ‚Äî pure placeholder content that violates Apple Guideline 2.1 (App Completeness). The real home screen is at (protected)/(tabs)/index.tsx. This file should not exist.\n\n2. mobile/app/(protected)/(tabs)/index.tsx: The 'Scan Your Face' button previously navigated to '/results' which doesn't exist. After enhance_005, it navigates to '/(protected)/scan'. Verify this is correct.\n\n3. mobile/app/(protected)/analysis/[id].tsx: Fix 'View Your Glow Plan' button route from '/(protected)/plan' to '/(protected)/glow-plan'. Fix 'Scan Again' button route from '/(protected)/scan' (now exists after enhance_005). These are already addressed in enhance_006 but verify.\n\n4. mobile/app/(protected)/_layout.tsx: Verify that all screens have proper tab bar configuration. Ensure 'home' (the legacy file) doesn't show up as a separate tab. The tabs should only be: (tabs)/index (Home icon), mewing, progress, settings. Hidden screens (href: null): glow-plan, analysis/[id], scan. Remove the home.tsx href entry if it exists in the Tabs config.\n\n5. mobile/app/index.tsx: After enhance_004, verify the routing chain works: onboarding ‚Üí auth/guest ‚Üí protected. Ensure there are no circular redirects.\n\nThis task is primarily cleanup ‚Äî removing placeholder content and ensuring all navigation paths lead to real, functional screens.",
      "status": "pending",
      "priority": 8,
      "depends_on": [
        "enhance_004",
        "enhance_005"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    }
  ]
}